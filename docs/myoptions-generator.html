<!DOCTYPE html>
<html>
<head>
  <script>
    var GVERSION="v0.3.4";
    var debug = false;
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, minimum-scale=0.25">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAgVBMVEUAAADXwlPcyVjYw1PYxFTcyVjYxFTbyFfZxlXax1bcyVjax1bbyFfaxlbaxlbbyFfZxVXZxVXbx1fbyFfcyFjbx1fcyVjYxFTZxVXZxVXbx1fcyFfaxlbcyFjcyVjcyVjax1bcyVjcyVjaxlbaxlbbyFfbyFfcyVjax1bbyFfWwVJAMS6TAAAAKnRSTlMA+wv49AXsas+jFp+Cy71T496PTD+IM/Dn2ZpHxzknHbEtDsK5dVwjrF8iY+RUAAAB/UlEQVRYw+2W2ZabMBBE1QgkxA4GjPHu8TLp///ATBxsKcRIzeQhOSdz30qm6ohuqTH7R4kSpeIr0+S9UsmN7JclR0T/bT9o77wERCgSqt/Hn5Snuw7CQfOG5A8EPlD3heSp/R0l4IJPePChvUIvxJSADDX3ANSElIDQErCiBBzGAaD1hhKwwCci0E24Q2vkCh/IUWIXkAJ25aPmw/PNoEXNaBx7AcBX0ht0cA05gFAto+K168XaPDS3D709sf+Qm4yVUnG1/pS7Pi8B8A5A0Xsz7XkB+AuQzYpIAX+DJ2T7domvgIzo/8ZxgpDkX3Cc5EAZ6T5OA5JymW0Ipz+BUe1HW+hdAQIN3mrP8/YxzNhCYzzM62Gg7Dt6FTrUtLqwS2NX5BbGgXGyqe/wjppIL5tb4EdbQKn9pTnBThtiEYx3VZGniSodUNluETd64JsYP7xbAtYc3Wzsx9BNagmo/npAA39YgwslILONcqMLMIGf2D7s3Plfgj4NSu8zASFqaorB1sdix+Zz5GbDt2zMft5M7mQbGDOhzauzM0ACmhS9zBd1vchz2WQdIETOhBJHABfCBxjE1f1d52ijZ06U4xy72aCFkhAQpDiNzygcpuvA96SES4ETQM5IRHEBr+wi2zIiUZN2vun1xSpr2nkXQ8aHNPxBmsWVbNkXr/kONfy904/qMY8AAAAASUVORK5CYII=">
  <title>ёRadio - simple myoptions.h generator</title>
  <style>
    html, body {margin: 0; padding: 0; height: 100%; }
    body {
      background-color: #000;
      color: #ccc;
      font-family: Times, "Times New Roman", serif;
      font-size: 16px;
    }
    a { color: #e3d25f; text-decoration: none; font-weight: bold }
    a:hover { text-decoration: underline }
    h1 {
      line-height: 48px;
      margin: 0 auto;
      padding: 0 0 20px 0;
      font-weight: bold;
      font-size: 26px;
      color: #e3d25f;
      text-align: center;
    }
    #slogan {
      margin: -26px 0 36px 0;
      color: #777;
      font-weight: normal;
      text-align: center;
      font-size: 16px;
    }
    #content {
      width: 100%;
      max-width: 1000px;
      padding: 20px 60px;
      box-sizing: border-box;
      margin: 0 auto;
      position: relative;
    }
    #topbtn {
      position: fixed;
      bottom: 0;
      left: 0;
      top: 0;
      z-index: 99;
      font-size: 24px;
      font-weight: bold;
      border: none;
      outline: none;
      background-color: transparent;
      color: #555;
      cursor: pointer;
      padding: 20px;
    }
    #topbtn:hover {
      background-color: rgba(50,50,50,0.1);
      color: #e3d25f;
    }
    .hidden {
	    display: none!important;
    }
    .subtitle {
      margin: -10px 0 10px 0;
      text-align: center;
      color: #666;
      font-size: 16px;
      text-transform: uppercase;
    }
    hr, #footer {
      border: 0;
      border-top: #444 1px solid;
      background: transparent;
      margin: 20px 30px 40px 30px;
      border-top-style: dotted;
    }
    hr.double {
      border-width: 3px;
    }
    hr.simple {
      border: 0;
      border-top: #444 1px solid;
      background: transparent;
      border-top-style: dotted;
      margin: 10px 30px 10px 30px;
    }
    .description {
      text-align: center;
      margin: 10px 40px 0 40px;
      border-top: #444 1px solid;
      padding-top: 10px;
    }
    .href {
      color: #e3d25f;
      text-align: center;
      font-weight: bold;
      font-size: 20px;
      cursor: pointer;
      margin: 30px 0 -20px 0;
    }
    .href:hover{
      text-decoration: underline;
    }
    #alert {
      width: 600px;
      box-sizing: border-box;
      margin: 0px -300px 0 0;
      padding: 20px;
      position: fixed;
      right: 50%;
      z-index: 99;
      border: #e3d25f 3px solid;
      background-color: #beb051;
      color: #000;
      border-radius: 10px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
    }
    #alert.info {
      border-color: #76db5b;
      background-color: #62b74b;
      color: #23431a;
    }
    #alert.warning {
      border-color: #e3aa5f;
      background-color: #c59453;
      color: #43341a;
    }
    #alert.error {
      border-color: #e35f5f;
      background-color: #ca5555;
      color: #431a1a;
    }
    section {
      border: #333 1px solid;
      border-radius: 10px;
      box-sizing: border-box;
      padding: 20px 20px 20px 20px;
      margin-top: 10px;
      width: 100%;
      margin-bottom: 30px;
      background-image: linear-gradient(#000, #0b0b0b);
      position: relative;
    }
    section .title {
      width: auto;
      margin-top: -34px;
      padding: 4px 0 20px 0;
      text-align: center;
    }
    section .title span {
      padding: 4px 8px;
      background: #000;
      font-weight: bold;
      font-size: 18px;
      text-transform: uppercase;
    }
    #info-content {
      display: flex;
    }
    #info-content ul {
      flex: 1;
      color: #aaa;
    }
    #info-content ul li {
      margin-bottom: 8px;
    }
    .scontent-displays {
      display: grid;
      grid-template-columns: 20% 20% 20% 20% 20%;
    }
    .scontent-audio, #audio-pins-spi, #audio-pins-i2s, #audio-spi-mode, #display-spi-mode {
      display: flex;
      justify-content: space-evenly;
    }
    .radio, .checkbox {
      position: absolute;
      cursor: pointer;
      opacity: 0;
      z-index: 5;
      width: 100%;
      margin: 0 0 0 -40px;
      height: 29px;
    }
    .dsplabel {
      position: relative;
      display: inline-block;
      padding-left: 32px;
      margin: 0 10px 12px 10px;
      font-size: 16px;
      line-height: 25px;
      text-transform: uppercase;
      color: #aaa;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    .dsplabel:has(> input:checked) {
      color: #fff;
      font-weight: bold;
    }
    .checkmark {
      position: absolute;
      top: 0;
      left: 0;
      height: 20px;
      width: 20px;
      background-color: #272727;
      border-radius: 50%;
      border: #777 2px solid;
    }
    .checkmark:after {
      display: block;
      top: 5px;
      left: 5px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #e3d25f;
    }
    .checkmark.box, .checkmark.box:after {
      border-radius: 0%;
    }
    .dsplabel:hover input ~ .checkmark {
      background-color: #272727;
    }
    .dsplabel input:checked ~ .checkmark {
      background-color: #272727;
      border: #e3d25f 2px solid;
    }
    .dsplabel input:checked ~ .checkmark:after {
      display: block;
    }
    .checkmark:after {
      content: "";
      position: absolute;
      display: none;
    }
    .inputwrap {
      flex: 1;
      position: relative;
      padding-top: 20px;
      max-width: 140px;
    }
    .inputtitle {
      display: inline-block;
      position: absolute;
      left: 0;
      top: 0;
      padding-left: 4px;
      color: #b7b7b7;
      text-transform: uppercase;
    }
    .textinput {
      width: 97%;
      max-width: 140px;
      box-sizing: border-box;
      background: #272727;
      color: #e3d25f;
      padding: 6px 12px;
      font-size: 20px;
      border: #777 3px solid;
      font-weight: normal;
      box-sizing: border-box;
      margin-top: 4px;
      border-radius: 8px;
      text-align: center;
    }
    .textinput::selection {  background: #aaa; color: #000; }
    #pins-lcd .textinput, #pins-lcd .inputwrap,
    #pins-buttons .textinput, #pins-buttons .inputwrap {
      max-width: 100px;
    }
    .textinput:focus {
      outline: none;
      border-color: #e3d25f;
      background: #474747;
    }
    .textinput.error{
      border-color: red;
      background: #381212;
    }
    .inputwrap:has(> .textinput:focus) .inputtitle {
      color: #fff;
      font-weight: bold;
    }
    #pins-i2c, #pins-lcd, #display-pins-spi, #pins-nextion, .evenly {
      display: flex;
      justify-content: space-evenly;
    }
    #submit {
      max-width: 500px;
      margin: 0 auto;
    }
    .button {
      padding: 8px 22px;
      font-size: 18px;
      border: #e3d25f 2px solid;
      font-weight: normal;
      box-sizing: border-box;
      border-radius: 20px;
      cursor: pointer;
      text-align: center;
      min-width: 140px;
      margin-left: 20px;
      text-transform: uppercase;
      color: #e3d25f;
      background: #272727;
    }
    .button:hover {
      background: #e3d25f;
      color: #000;
      text-decoration: none;
    }
    .button:active {
      position: relative;
      top: 2px;
    }
    .hlbutton {
      background: #e3d25f;
      color: #000;
    }
    .encoder-set {
      margin-top: 30px;
    }
    #footer {
      text-align: center;
      padding: 40px 0 20px 0;
      color: #aaa;
      margin: 60px 0 0 0;
      border-width: 2px;
      line-height: 26px;
    }
  </style>
  </head>
<body>
  <div id="content">
    <div id="alert" class="hidden" onclick="dontAlert();"></div>
    <h1 id="pagetitle">ёRadio - myoptions generator</h1>
    <h2 id="slogan">feel difference</h2>
    <!-- INFO -->
    <section id="info">
      <div class="title"><span>commandments</span></div>
      <div id="info-content">
        <ul>
          <li>Do not use 16-17 pins on WROVER module.</li>
          <li>Do not pullup the 12th pin from the outside.</li>
          <li>Empty value = error.</li>
          <li>GPIOs 34 to 39 are GPIs – input only pins. These pins don’t have internal pull-up or pull-down resistors. They can’t be used as outputs, so use these pins only as inputs.</li>
          <li>Connect display and VS RST-pin to EN ESP32 pin (value&nbsp;-1)</li>
        </ul>
        <ul>
          <li>Please check out this article: <a href="https://randomnerdtutorials.com/esp32-pinout-reference-gpios/" target="_blank">https://randomnerdtutorials.com/esp32-pinout-reference-gpios/</a></li>
          <li>Please check out this article: <a href="https://github.com/e2002/yoradio#hardware-setup" target="_blank">https://github.com/e2002/yoradio#hardware-setup</a></li>
          <li>Please check out this article: <a href="https://github.com/e2002/yoradio/wiki/How-to-flash" target="_blank">https://github.com/e2002/yoradio/wiki/How-to-flash</a></li>
        </ul>
      </div>
    </section><!-- INFO -->
    <!-- SETUP -->
    <hr class="double" />
    <section id="setup">
      <div class="title"><span>i need to set up</span></div>
      <div class="scontent scontent-setup evenly" id="scontent-setup1">
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r1" data-target="setup-language"/><span class="checkmark box"></span>language</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r2" data-target="setup-display"/><span class="checkmark box"></span>DISPLAY</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r3" data-target="setup-buttons"/><span class="checkmark box"></span>BUTTONS</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r4" data-target="setup-encoders"/><span class="checkmark box"></span>ENCODERS</label>
      </div>
      <hr />
      <div class="scontent scontent-setup evenly" id="scontent-setup2">
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r5" data-target="setup-touchscreen"/><span class="checkmark box"></span>TOUCHSCREEN</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r6" data-target="setup-sdcard"/><span class="checkmark box"></span>SD CARD</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r7" data-target="setup-etc"/><span class="checkmark box"></span>IR, LED, ETC.</label>
      </div>
    </section><!-- SETUP -->
    <!-- LANGUAGE -->
    <div id="setup-language" class="hidden">
      <hr class="double" />
      <section id="language">
        <div class="title"><span>language</span></div>
        <div class="scontent scontent-language evenly forexport" id="scontent-language" data-define="L10N_LANGUAGE" data-export="RADIO">
          <label class="dsplabel"><input type="radio" class="radio rbox" name="rlanguage" id="r8" data-type="default" checked /><span class="checkmark"></span>EN</label>
          <label class="dsplabel"><input type="radio" class="radio rbox" name="rlanguage" id="r9" data-type="RU" /><span class="checkmark"></span>RU</label>
        </div>
      </section>
    </div><!-- LANGUAGE -->
    <!-- DISPLAY -->
    <div id="setup-display" class="hidden">
      <hr class="double" />
      <section id="display">
        <div class="title"><span>display</span></div>
        <div class="scontent scontent-displays forexport" id="scontent-displays" data-define="DSP_MODEL" data-export="RADIO" data-displays="true">
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r10" data-target="dmy" data-type="default" checked /><span class="checkmark"></span>no display</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r11" data-target="spi" data-st="ST7735" data-type="DSP_ST7735" /><span class="checkmark"></span>ST7735</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r12" data-target="i2c" data-type="DSP_SSD1306" data-invert="true"/><span class="checkmark"></span>SSD1306</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r13" data-target="spi" data-type="DSP_NOKIA5110" /><span class="checkmark"></span>NOKIA 5110</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r14" data-target="spi" data-type="DSP_ST7789" /><span class="checkmark"></span>ST7789</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r15" data-target="i2c" data-type="DSP_SH1106" data-invert="true" /><span class="checkmark"></span>SH1106</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r16" data-target="i2c" data-type="DSP_1602I2C" /><span class="checkmark"></span>1602 I2C</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r17" data-target="i2c" data-type="DSP_SSD1306x32" /><span class="checkmark"></span>SSD1306x32</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r18" data-target="i2c" data-type="DSP_SSD1327" data-rotate="true" /><span class="checkmark"></span>SSD1327</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r19" data-target="spi" data-type="DSP_ILI9341" /><span class="checkmark"></span>ILI9341</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r20" data-target="spi" data-type="DSP_SSD1305" data-invert="true" /><span class="checkmark"></span>SSD1305</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r21" data-target="i2c" data-type="DSP_SH1107" /><span class="checkmark"></span>SH1107</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r22" data-target="lcd" data-type="DSP_1602" /><span class="checkmark"></span>LCD 1602</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r23" data-target="spi" data-type="DSP_GC9106" /><span class="checkmark"></span>GC9106</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r24" data-target="i2c" data-type="DSP_2004I2C" /><span class="checkmark"></span>2004 I2C</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r25" data-target="lcd" data-type="DSP_2004" /><span class="checkmark"></span>LCD 2004</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r26" data-target="i2c" data-type="DSP_SSD1305I2C" data-invert="true" /><span class="checkmark"></span>SSD1305 I2C</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r27" data-target="spi" data-type="DSP_ILI9225" /><span class="checkmark"></span>ILI9225</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r28" data-target="spi" data-type="DSP_ST7789_240" data-rotate="true" /><span class="checkmark"></span>ST7789x240</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r29" data-target="spi" data-type="DSP_ST7796" /><span class="checkmark"></span>ST7796</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r30" data-target="spi" data-type="DSP_GC9A01A" /><span class="checkmark"></span>GC9A01A</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r31" data-target="spi" data-type="DSP_ILI9488" /><span class="checkmark"></span>ILI9488</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r32" data-target="spi" data-type="DSP_ILI9486" /><span class="checkmark"></span>ILI9486</label>
        </div>
        <hr style="margin: 10px 40px 20px 40px;" />
        <div class="evenly">
          <label class="dsplabel"><input type="checkbox" class="checkbox rbox plus-nextion" name="dspbox" id="r33" /><span class="checkmark box"></span>+ NEXTION</label>
          <label class="dsplabel hidden" id="dsp-rotate" title="Optional 90 degree rotation for square displays"><input type="checkbox" class="checkbox rbox rotate90" id="r34" name="dspbox" /><span class="checkmark box"></span>ROTATE 90&#176;</label>
          <label class="dsplabel hidden" id="dsp-invert" title="Invert title colors for OLED displays"><input type="checkbox" class="checkbox rbox invert-title" id="r35" name="dspbox" /><span class="checkmark box"></span>INVERT TITLE</label>
        </div>
        <div class="description"><a href="https://github.com/e2002/yoradio/wiki/Available-display-models" target="_blank">Available display models</a></div>
      </section>
      <section id="display-pins" class="hidden">
        <div class="title"><span>display pins</span></div>
        <div class="scontent scontent-displays-pins">
          <div id="pins-7735" class="hidden">
            <h3 class="subtitle">ST7735 display type</h3>
            <div class="evenly forexport" data-define="DTYPE" data-export="RADIO">
              <label class="dsplabel" title="1.8' display. If the display is cut off or has extra 'random' pixels on the top & left, try the other option!"><input type="radio" id="r36" class="radio dspradio rbox initr-blacktab" name="initrradio" data-type="default" checked /><span class="checkmark"></span>BLACKTAB</label>
              <label class="dsplabel" title="1.8' display. If the display is cut off or has extra 'random' pixels on the top & left, try the other option!"><input type="radio" class="radio dspradio rbox" id="r37" name="initrradio" data-type="INITR_GREENTAB" /><span class="checkmark"></span>GREENTAB</label>
              <label class="dsplabel" title="1.8' display. If the display is cut off or has extra 'random' pixels on the top & left, try the other option!"><input type="radio" class="radio dspradio rbox" id="r38" name="initrradio" data-type="INITR_REDTAB" /><span class="checkmark"></span>REDTAB</label>
              <label class="dsplabel" title="1.44' display."><input type="radio" class="radio dspradio rbox" id="r39" name="initrradio" data-rotate="true" data-type="INITR_144GREENTAB" /><span class="checkmark"></span>144GREENTAB</label>
              <label class="dsplabel" title="0.96' display."><input type="radio" class="radio dspradio rbox" id="r40" name="initrradio" data-type="INITR_MINI160x80" /><span class="checkmark"></span>MINI160x80</label>
            </div>
            <hr />
          </div>
          <div id="pins-spi" class="hidden displays-spi">
            <div id="display-spi-mode-wrap">
              <h3 class="subtitle">DISPLAY SPI BUS</h3>
              <div id="display-spi-mode" class="forexport" data-define="DSP_HSPI" data-export="RADIO">
                <label class="dsplabel"><input type="radio" class="radio rbox" id="r41" name="dspspitype" data-type="default" checked /><span class="checkmark"></span>VSPI (mosi-23, miso-19, sck-18)</label>
                <label class="dsplabel"><input type="radio" class="radio rbox" id="r42" name="dspspitype" data-type="true" /><span class="checkmark"></span>HSPI (mosi-13, miso-12, sck-14)</label>
              </div>
              <hr />
            </div>
            <div id="display-pins-spi" class="forexport" data-export="PINS">
              <div class="inputwrap"><span class="inputtitle">DC</span><input type="text" class="textinput" id="i1" data-define="TFT_DC" value="5" maxlength="3"></div>
              <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i2" data-define="TFT_CS" value="4" maxlength="3"></div>
              <div class="inputwrap"><span class="inputtitle">RST</span><input type="text" class="textinput" id="i3" data-define="TFT_RST" value="-1" maxlength="3"></div>
              <div class="inputwrap"><span class="inputtitle">BACKLIGHT</span><input type="text" class="textinput" id="i4" data-define="BRIGHTNESS_PIN" value="255" maxlength="3"></div>
            </div>
          </div>
          <div id="pins-i2c" class="hidden displays-pins forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">SDA</span><input type="text" class="textinput" id="i5" data-define="I2C_SDA" value="21" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">SCL</span><input type="text" class="textinput" id="i6" data-define="I2C_SCL" value="22" maxlength="3"></div>
          </div>
          <div id="pins-lcd" class="hidden displays-pins forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">RS</span><input type="text" class="textinput" id="i7" data-define="LCD_RS" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">E</span><input type="text" class="textinput" id="i8" data-define="LCD_E" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D4</span><input type="text" class="textinput" id="i9" data-define="LCD_D4" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D5</span><input type="text" class="textinput" id="i10" data-define="LCD_D5" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D6</span><input type="text" class="textinput" id="i11" data-define="LCD_D6" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D7</span><input type="text" class="textinput" id="i12" data-define="LCD_D7" value="" maxlength="3"></div>
          </div>
        </div>
      </section>
      <section id="nextion" class="hidden">
        <div class="title"><span>nextion pins</span></div>
        <div id="pins-nextion" class="displays-pins forexport" data-export="PINS">
          <div class="inputwrap"><span class="inputtitle">RX</span><input type="text" class="textinput" id="i13" data-define="NEXTION_RX" value="" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">TX</span><input type="text" class="textinput" id="i14" data-define="NEXTION_TX" value="" maxlength="3"></div>
        </div>
      </section>
    </div><!-- DISPLAY -->
    <!-- AUDIO -->
    <hr class="double" />
    <section id="audio">
      <div class="title"><span>audio</span></div>
      <div class="scontent scontent-audio forexport" id="scontent-audio" data-export="AUDIO">
        <label class="dsplabel"><input type="radio" class="radio rbox" id="r43" name="audioradio" data-target="i2s" checked /><span class="checkmark"></span>I2S EXTERNAL</label>
        <label class="dsplabel"><input type="radio" class="radio rbox vs1053" id="r44" name="audioradio" data-target="vs"  /><span class="checkmark"></span>VS1053</label>
        <label class="dsplabel"><input type="radio" class="radio rbox i2s-internal" id="r45" name="audioradio" data-target="int"  /><span class="checkmark"></span>INTERNAL</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox force-mono" id="r46" data-target="PLAYER_FORCE_MONO"/><span class="checkmark box"></span>MONO</label>
      </div>
    </section>
    <section id="audio-pins">
      <div class="title"><span>audio pins</span></div>
      <div class="scontent scontent-audio-pins">
        <div id="audio-pins-i2s" class="audio-pins forexport" data-export="PINS">
          <div class="inputwrap"><span class="inputtitle">DIN | DOUT</span><input type="text" class="textinput" id="i15" data-define="I2S_DOUT" value="27" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">BCLK</span><input type="text" class="textinput" id="i16" data-define="I2S_BCLK" value="26" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">LRC | WSEL</span><input type="text" class="textinput" id="i17" data-define="I2S_LRC" value="25" maxlength="3"></div>
        </div>
        <div id="audio-pins-spi-wrap" class="hidden audio-pins">
          <div id="audio-spi-mode-wrap">
            <h3 class="subtitle">AUDIO SPI BUS</h3>
            <div id="audio-spi-mode" class="forexport" data-define="VS_HSPI" data-export="RADIO">
              <label class="dsplabel"><input type="radio" class="radio rbox" id="r47" name="audiospitype" data-type="default" checked /><span class="checkmark"></span>VSPI (mosi-23, miso-19, sck-18)</label>
              <label class="dsplabel"><input type="radio" class="radio rbox" id="r48" name="audiospitype" data-type="true" /><span class="checkmark"></span>HSPI (mosi-13, miso-12, sck-14)</label>
            </div>
            <hr />
          </div>
          <div id="audio-pins-spi" class="forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i18" data-define="VS1053_CS" value="27" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">DCS</span><input type="text" class="textinput" id="i19" data-define="VS1053_DCS" value="25" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">DREQ</span><input type="text" class="textinput" id="i20" data-define="VS1053_DREQ" value="26" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">RST</span><input type="text" class="textinput" id="i21" data-define="VS1053_RST" value="-1" maxlength="3"></div>
          </div>
        </div>
      </div>
    </section><!-- AUDIO -->
    <!-- BUTTONS -->
    <div id="setup-buttons" class="hidden">
      <hr class="double" />
      <section id="buttons">
        <div class="title"><span>buttons</span></div>
        <div class="scontent scontent-buttons evenly" id="scontent-buttons">
          <label class="dsplabel"><input type="checkbox" class="checkbox rbox control-buttons" name="buttonsuse" id="r49" /><span class="checkmark box"></span>control buttons</label>
          <label class="dsplabel hiddenradio hidden"><input type="radio" class="radio rbox" id="r50" name="buttonsnum" data-target="treebuttons" checked /><span class="checkmark"></span>THREE BUTTONS</label>
          <label class="dsplabel hiddenradio hidden"><input type="radio" class="radio rbox five-buttons" id="r51" name="buttonsnum" data-target="fivebuttons"  /><span class="checkmark"></span>FIVE BUTTONS</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox rbox mode-button" name="buttonmode" id="r52" /><span class="checkmark box"></span>MODE BUTTON</label>
        </div>
      </section>
      <section id="buttons-pins" class="hidden">
        <div class="title"><span>buttons pins</span></div>
        <div id="pins-buttons" class="buttons-pins evenly forexport" data-export="PINS">
          <div class="inputwrap threebuttons pinbuttons hidden"><span class="inputtitle">PREV</span><input type="text" class="textinput" id="i22" data-define="BTN_LEFT" value="" maxlength="3"></div>
          <div class="inputwrap threebuttons pinbuttons hidden"><span class="inputtitle">PLAY</span><input type="text" class="textinput" id="i23" data-define="BTN_CENTER" value="" maxlength="3"></div>
          <div class="inputwrap threebuttons pinbuttons hidden"><span class="inputtitle">NEXT</span><input type="text" class="textinput" id="i24" data-define="BTN_RIGHT" value="" maxlength="3"></div>
          <div class="inputwrap fivebuttons pinbuttons hidden"><span class="inputtitle">UP</span><input type="text" class="textinput" id="i25" data-define="BTN_UP" value="" maxlength="3"></div>
          <div class="inputwrap fivebuttons pinbuttons hidden"><span class="inputtitle">DOWN</span><input type="text" class="textinput" id="i26" data-define="BTN_DOWN" value="" maxlength="3"></div>
          <div class="inputwrap hidden" id="modebutton"><span class="inputtitle">MODE</span><input type="text" class="textinput" id="i27" data-define="BTN_MODE" value="" maxlength="3"></div>
        </div>
        <hr />
        <div class="evenly"><label class="dsplabel"><input type="checkbox" class="checkbox rbox buttonspullup" name="buttonpullup" id="r53" checked /><span class="checkmark box"></span>INTERNAL PULLUP</label></div>
      </section>
    </div><!-- BUTTONS -->
    <!-- ENCODERS -->
    <div id="setup-encoders" class="hidden">
      <hr class="double" />
      <section id="encoders">
        <div class="title"><span>encoders</span></div>
        <div class="scontent scontent-encoders evenly" id="scontent-encoders">
          <label class="dsplabel"><input type="checkbox" class="checkbox encodercheckbox rbox encoder-box1" name="encoder1" id="r54" /><span class="checkmark box"></span>ENCODER #1</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox encodercheckbox rbox encoder-box2" name="encoder2" id="r55" /><span class="checkmark box"></span>ENCODER #2</label>
        </div>
      </section>
      <section id="encoders-pins" class="hidden">
        <div class="title"><span>encoders pins</span></div>
        <div id="epins1" class="hidden">
          <h3 class="subtitle">Encoder #1</h3>
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">S1</span><input type="text" class="textinput" id="i28" data-define="ENC_BTNR" value="36" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">S2</span><input type="text" class="textinput" id="i29" data-define="ENC_BTNL" value="34" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">Key</span><input type="text" class="textinput" id="i30" data-define="ENC_BTNB" value="39" maxlength="3"></div>
          </div>
          <div class="encoder-set evenly forexport" data-export="SET">
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc1pullup" id="r56" data-default="true" data-define="ENC_INTERNALPULLUP" /><span class="checkmark box"></span>INTERNAL PULLUP</label>
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc1half" id="r57" data-default="false" data-define="ENC_HALFQUARD" /><span class="checkmark box"></span>HALFQUARD</label>
          </div>
        </div>
        <hr id="ehr" class="hidden" />
        <div id="epins2" class="hidden">
          <h3 class="subtitle">Encoder #2</h3>
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">S1</span><input type="text" class="textinput" id="i31" data-define="ENC2_BTNR" value="35" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">S2</span><input type="text" class="textinput" id="i32" data-define="ENC2_BTNL" value="33" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">Key</span><input type="text" class="textinput" id="i33" data-define="ENC2_BTNB" value="32" maxlength="3"></div>
          </div>
          <div class="encoder-set evenly forexport" data-export="SET">
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc2pullup" id="r58" data-default="true" data-define="ENC2_INTERNALPULLUP" /><span class="checkmark box"></span>INTERNAL PULLUP</label>
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc2half" id="r59" data-default="false" data-define="ENC2_HALFQUARD" /><span class="checkmark box"></span>HALFQUARD</label>
          </div>
        </div>
      </section>
    </div><!-- ENCODERS -->
    <!-- TOUCHSCREEN -->
    <div id="setup-touchscreen" class="hidden">
      <hr class="double" />
      <section id="touchscreen">
        <div class="title"><span>touch screen</span></div>
        <div class="evenly forexport" data-define="TS_MODEL" data-export="RADIO">
          <label class="dsplabel"><input type="radio" class="radio tsradio rbox" name="touchscreenmodel" id="r60" data-target="ts-res" data-type="TS_MODEL_XPT2046" checked /><span class="checkmark"></span>XPT2046</label>
          <label class="dsplabel"><input type="radio" class="radio tsradio rbox" name="touchscreenmodel" id="r61" data-target="ts-cap" data-type="TS_MODEL_GT911"  /><span class="checkmark"></span>GT911</label>
        </div>
        <hr />
        <div class="ts-pins" id="ts-res">
          <h3 class="subtitle" style="margin-top: -30px;">TS SPI BUS</h3>
          <div class="evenly forexport" data-define="TS_HSPI" data-export="RADIO">
            <label class="dsplabel"><input type="radio" class="radio rbox" id="r62" name="tsspitype" data-type="default" checked /><span class="checkmark"></span>VSPI (mosi-23, miso-19, sck-18)</label>
            <label class="dsplabel"><input type="radio" class="radio rbox" id="r63" name="tsspitype" data-type="true" /><span class="checkmark"></span>HSPI (mosi-13, miso-12, sck-14)</label>
          </div>
          <hr class="simple" />
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i34" data-define="TS_CS" value="13" maxlength="3"></div>
          </div>
        </div>
        <div class="ts-pins evenly hidden forexport" id="ts-cap" data-export="PINS">
          <div class="inputwrap"><span class="inputtitle">SDA</span><input type="text" class="textinput" id="i35" data-define="TS_SDA" value="33" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">SCL</span><input type="text" class="textinput" id="i36" data-define="TS_SCL" value="32" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">INT</span><input type="text" class="textinput" id="i37" data-define="TS_INT" value="21" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">RST</span><input type="text" class="textinput" id="i38" data-define="TS_RST" value="22" maxlength="3"></div>
        </div>
      </section>
    </div><!-- TOUCHSCREEN -->
    <!-- SDCARD -->
    <div id="setup-sdcard" class="hidden">
      <hr class="double" />
      <section id="sdcard">
        <div class="title"><span>sd card</span></div>
        <div class="sd-pins">
          <h3 class="subtitle">SD SPI BUS</h3>
          <div class="evenly forexport" data-define="SD_HSPI" data-export="RADIO">
            <label class="dsplabel"><input type="radio" class="radio rbox" id="r64" name="sdspitype" data-type="default" checked /><span class="checkmark"></span>VSPI (mosi-23, miso-19, sck-18)</label>
            <label class="dsplabel"><input type="radio" class="radio rbox" id="r65" name="sdspitype" data-type="true" /><span class="checkmark"></span>HSPI (mosi-13, miso-12, sck-14)</label>
          </div>
          <hr class="simple" />
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i39" data-define="SDC_CS" value="" maxlength="3"></div>
          </div>
        </div>
      </section>
    </div><!-- SDCARD -->
    <!-- ETC -->
    <div id="setup-etc" class="hidden">
      <hr class="double" />
      <section id="etc">
        <div class="title"><span>etc.</span></div>
        <div class="evenly">
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r66" data-target="etc-led"/><span class="checkmark box"></span>LED PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r67" data-target="etc-ir"/><span class="checkmark box"></span>IR PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r68" data-target="etc-mute"/><span class="checkmark box"></span>MUTE PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r69" data-target="etc-wake"/><span class="checkmark box"></span>WAKE PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r70" data-target="etc-light"/><span class="checkmark box"></span>LIGHT SENSOR</label>
        </div>
        <hr class="simple" />
        <div class="evenly forexport" data-export="PINS">
          <div class="inputwrap hidden" id="etc-led"><span class="inputtitle">led indicator</span><input type="text" class="textinput" id="i40" data-define="LED_BUILTIN" value="2" maxlength="3"></div>
          <div class="inputwrap hidden" id="etc-ir"><span class="inputtitle">ir</span><input type="text" class="textinput" id="i41" data-define="IR_PIN" value="255" maxlength="3"></div>
          <div class="inputwrap hidden" id="etc-mute"><span class="inputtitle">mute</span><input type="text" class="textinput" id="i42" data-define="MUTE_PIN" value="255" maxlength="3"></div>
          <div class="inputwrap hidden" id="etc-wake"><span class="inputtitle">wake</span><input type="text" class="textinput" id="i43" data-define="WAKE_PIN" value="255" maxlength="3"></div>
          <div class="inputwrap hidden" id="etc-light"><span class="inputtitle">light sensor</span><input type="text" class="textinput" id="i44" data-define="LIGHT_SENSOR" value="255" maxlength="3"></div>
        </div>
      </section>
    </div><!-- ETC -->
    <hr class="double" />
    <div id="submit" class="evenly">
      <div class="button apply" id="btnreset" onclick="window.scrollTo(0, 0); window.location.href = window.location.href.split('?')[0];">reset</div>
      <div class="button apply hlbutton" id="btnreset" onclick="doExport();">yoooo!</div>
    </div>
    <div class="href" onclick="getLink();">>> get link to this configuration <<</div>
    <div id="footer"></div>
    <button onclick="topFunction()" id="topbtn">&#8593;</button>
  </div>
</body>
<script>
  var defaultValues = { "TFT_DC":       5,   "TFT_CS":        4,  "TFT_RST":    -1, "BRIGHTNESS_PIN": 255,
                        "I2C_SDA":      21,  "I2C_SCL":       22, 
                        "I2S_DOUT":     27,  "I2S_BCLK":      26, "I2S_LRC":    25,
                        "VS1053_DCS":   25,  "VS1053_DREQ":   26, "VS1053_RST": -1,
                        "TS_CS":        13,  "TS_SDA":        33, "TS_SCL":     32, "TS_INT":         21,   "TS_RST": 25,
                        "LED_BUILTIN":  255, "MUTE_PIN":      255,"WAKE_PIN":   255,"LIGHT_SENSOR":   255,  "IR_PIN": 255 };
  
  var atimeout;
  window.addEventListener('load', onLoad);

  function dontAlert(){
    document.getElementById("alert").setAttribute("class", "hidden");
    document.getElementById("alert").innerHTML = "";
    if(atimeout) clearTimeout(atimeout);
  }
  function doAlert(atype, atext){
    document.getElementById("alert").setAttribute("class", atype);
    document.getElementById("alert").innerHTML = atext;
    atimeout = setTimeout(dontAlert, 7000);
  }
  function saveAlert(atype, atext){
    localStorage.setItem('alert', atext);
    localStorage.setItem('atype', atype);
  }
  function loadAlert(){
    let salert = localStorage.getItem('alert');
    if(salert){
      let satype = localStorage.getItem('atype');
      doAlert(satype, salert);
      localStorage.removeItem('alert');
      localStorage.removeItem('atype');
    }
  }
  function dspRadioClick(){
    let target=this.getAttribute('data-target');
    document.getElementById("display-pins").classList.add("hidden");
    document.getElementById("pins-spi").classList.add("hidden");
    document.getElementById("pins-i2c").classList.add("hidden");
    document.getElementById("pins-lcd").classList.add("hidden");
    if(target!="dmy") document.getElementById("display-pins").classList.remove("hidden");
    if(target=="spi") document.getElementById("pins-spi").classList.remove("hidden");
    if(target=="i2c") document.getElementById("pins-i2c").classList.remove("hidden");
    if(target=="lcd") document.getElementById("pins-lcd").classList.remove("hidden");
    
    document.getElementById("pins-7735").classList.add("hidden");
    if(this.hasAttribute('data-st')) {
      document.getElementById("pins-7735").classList.remove("hidden");
      document.getElementsByClassName("initr-blacktab")[0].click();
    }
  }
  function nextionBoxClick(){
    if(this.checked){
      document.getElementById("nextion").classList.remove("hidden");
    }else{
      document.getElementById("nextion").classList.add("hidden");
    }
  }
  function buttonsUseClick(){
    let hiddenradio = document.getElementById("scontent-buttons").getElementsByClassName("hiddenradio");
    let  pinbuttons = document.getElementsByClassName(" pinbuttons");
    if(this.checked){
      document.getElementById("buttons-pins").classList.remove("hidden");
      for (var i = 0; i < hiddenradio.length; i++) {
        hiddenradio[i].classList.remove("hidden");
      }
      for (var i = 0; i < pinbuttons.length; i++) {
        if(document.getElementsByClassName("five-buttons")[0].checked){
          pinbuttons[i].classList.remove("hidden");
        }else{
          if(pinbuttons[i].classList.contains("threebuttons")) pinbuttons[i].classList.remove("hidden");
        }
      }
    }else{
      if(!document.getElementsByClassName("mode-button")[0].checked) document.getElementById("buttons-pins").classList.add("hidden");
      for (var i = 0; i < hiddenradio.length; i++) {
        hiddenradio[i].classList.add("hidden");
      }
      for (var i = 0; i < pinbuttons.length; i++) {
         pinbuttons[i].classList.add("hidden");
      }
    }
  }
  function buttonsModeClick(){
    if(this.checked) document.getElementById("modebutton").classList.remove("hidden"); else document.getElementById("modebutton").classList.add("hidden");
    let controlButtons = document.getElementsByClassName("control-buttons")[0];
    if(!controlButtons.checked) document.getElementById("buttons-pins").classList.remove("hidden");
    if(!this.checked && !controlButtons.checked) document.getElementById("buttons-pins").classList.add("hidden");
  }
  function audioRadioClick(){
    let target=this.getAttribute('data-target');
    document.getElementById("audio-pins-spi-wrap").classList.add("hidden");
    document.getElementById("audio-pins-i2s").classList.add("hidden");
    document.getElementById("audio-pins").classList.remove("hidden");
    if(target=="int") document.getElementById("audio-pins").classList.add("hidden");
    if(target=="i2s") document.getElementById("audio-pins-i2s").classList.remove("hidden");
    if(target=="vs") document.getElementById("audio-pins-spi-wrap").classList.remove("hidden");
  }
  function buttonsRadioClick(){
    let target=this.getAttribute('data-target');
    let fbuttons = document.getElementsByClassName("fivebuttons");
    for (var i = 0; i < fbuttons.length; i++) {
      if(target=="treebuttons") fbuttons[i].classList.add("hidden"); else fbuttons[i].classList.remove("hidden");
    }
  }
  function encoderCheckboxClick(){
    let ebx1 = document.getElementsByClassName("encoder-box1")[0];
    let ebx2 = document.getElementsByClassName("encoder-box2")[0];
    let epinssection = document.getElementById("encoders-pins");
    if(ebx1.checked || ebx2.checked) epinssection.classList.remove("hidden"); else epinssection.classList.add("hidden");
    if(ebx1.checked) document.getElementById("epins1").classList.remove("hidden"); else document.getElementById("epins1").classList.add("hidden");
    if(ebx2.checked) document.getElementById("epins2").classList.remove("hidden"); else document.getElementById("epins2").classList.add("hidden");
    if(ebx1.checked && ebx2.checked) document.getElementById("ehr").classList.remove("hidden"); else document.getElementById("ehr").classList.add("hidden");
  }
  function setupCheckboxClick(){
    let target = this.getAttribute("data-target");
    let targetId = document.getElementById(target);
    if(targetId) targetId.classList.toggle("hidden");
  }
  function initCheckboxes(){
    let sdsp = document.getElementById("scontent-displays");
    let elements = sdsp.getElementsByClassName("radio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', dspRadioClick, false);
    }
    document.getElementsByClassName("plus-nextion")[0].addEventListener('click', nextionBoxClick, false);
    document.getElementsByClassName("control-buttons")[0].addEventListener('click', buttonsUseClick, false);
    document.getElementsByClassName("mode-button")[0].addEventListener('click', buttonsModeClick, false);
    sdsp = document.getElementById("scontent-audio");
    elements = sdsp.getElementsByClassName("radio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', audioRadioClick, false);
    }
    sdsp = document.getElementById("scontent-buttons");
    elements = sdsp.getElementsByClassName("radio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', buttonsRadioClick, false);
    }
    elements = document.getElementsByClassName("encodercheckbox");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', encoderCheckboxClick, false);
    }
    elements = document.getElementsByClassName("checkbox-setup");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', setupCheckboxClick, false);
    }
    elements = document.getElementsByClassName("dspradio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', function(){
        document.getElementById("dsp-rotate").classList.add("hidden");
        document.getElementById("dsp-invert").classList.add("hidden");
        if(this.checked && this.hasAttribute("data-rotate")) document.getElementById("dsp-rotate").classList.remove("hidden");
        if(this.checked && this.hasAttribute("data-invert")) document.getElementById("dsp-invert").classList.remove("hidden");
      }, false);
    }
    elements = document.getElementsByClassName("tsradio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', function(){
        let target = this.getAttribute("data-target");
        let tspins = document.getElementsByClassName("ts-pins");
        for (var k = 0; k < tspins.length; k++) {
          tspins[k].classList.add("hidden");
        }
        document.getElementById(target).classList.remove("hidden");
      }, false);
    }
    elements = document.getElementsByClassName("checkbox-etc");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', function(){
        let target = this.getAttribute("data-target");
        if(this.checked) document.getElementById(target).classList.remove("hidden"); else document.getElementById(target).classList.add("hidden");
      }, false);
    }
  }
  function validatePins(){
    let elements = document.getElementsByClassName("textinput");
    for (var i = 0; i < elements.length; i++) {
      elements[i].classList.remove("error");
    }
    for (var i = 0; i < elements.length; i++) {
      if(elements[i].offsetParent === null || elements[i].value=="" || elements[i].value=="-1" || elements[i].value=="255") continue;
      for (var k = 0; k < elements.length; k++) {
        if(elements[k].offsetParent === null || elements[k].value=="" || elements[i].value=="-1" || elements[i].value=="255") continue;
        if(elements[i]==elements[k]) continue;
        if(elements[i].value==elements[k].value){
          elements[i].classList.add("error");
          elements[k].classList.add("error");
          elements[i].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
          return false;
        }
      }
    }
    return true;
  }
  function initTextInputs(){
    let elements = document.getElementsByClassName("textinput");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('focus', function(){this.classList.remove("error");this.select();}, false);
      elements[i].addEventListener('blur', function(){
        validatePins();
      }, false);
    }
  }
  function loadConfigFromUrl(){
    let params = (new URL(document.location)).searchParams;
    let rr = params.get('r');
    let ii = params.get('i');
    let vv = params.get('v');
    if(!rr || !ii || !vv) return;
    try {
      var datarr = JSON.parse("["+rr+"]");
      var dataii = JSON.parse("["+ii+"]");
      var datavv = JSON.parse("[\""+vv.replaceAll(",", '","')+"\"]");
      
    } catch (error) {
      console.error(error);
      doAlert("error", error);
      return;
    }
    if(typeof datarr !== 'undefined'){
      let cboxes = document.getElementsByClassName("checkbox");
      for (var i = 0; i < cboxes.length; i++) {
        let aid = parseInt(cboxes[i].id.substr(1));
        if(datarr.includes(aid) && !cboxes[i].checked) cboxes[i].click();
        if(!datarr.includes(aid) && cboxes[i].checked) cboxes[i].click();
      }
      let rboxes = document.getElementsByClassName("radio");
      for (var i = 0; i < rboxes.length; i++) {
        let aid = parseInt(rboxes[i].id.substr(1));
        if(datarr.includes(aid)) rboxes[i].click();
      }
      /*for (var i = 0; i < data.r.length; i++) {
        document.getElementById("r"+data.r[i]).click();
      }*/
      for (var i = 0; i < dataii.length; i++) {
        document.getElementById("i"+dataii[i]).value = datavv[i].substr(0,3);
      }
    }
  }
  function onLoad(event) {
    document.title = document.title+" - "+GVERSION;
    let ttl = document.getElementById("pagetitle");
    ttl.innerText = document.title;
    document.getElementById("footer").innerHTML = document.title + '<br /><a href="https://github.com/e2002/yoradio/" target="_blank">project homepage</a>';
    initCheckboxes();
    initTextInputs();
    loadConfigFromUrl();
    loadAlert();
  }
  function topFunction(){
    window.scrollTo({
      top: 0,
      left: 0,
      behavior: 'smooth'
    });
  }
  function getLink(){
    let elements = document.getElementsByClassName("rbox");
    let rr = '';
    let vv = '';
    let ii = '';
    for (var i = 0; i < elements.length; i++) {
      if(elements[i].checked && elements[i].offsetParent !== null){
        rr += elements[i].id.substr(1)+",";
      }
    }
    rr = rr.slice(0, -1);
    elements = document.getElementsByClassName("textinput");
    for (var i = 0; i < elements.length; i++) {
      if(elements[i].value!="" && elements[i].offsetParent !== null){
        ii += elements[i].id.substr(1)+",";
        vv += elements[i].value+",";
      }
    }
    ii = ii.slice(0, -1);
    vv = vv.slice(0, -1);
    //let out = `{"r":[${rr}],"i":[${ii}],"v":[${vv}]}`;
    let out = `r=${rr}&i=${ii}&v=${vv}`;
    if(debug) console.log(out);
    let newlink = window.location.href.split('?')[0]+'?'+out;
    console.log("link to this configuration:");
    console.log(newlink);
    if(window.location.href.substr(0,4)!="http" && !debug){
      doAlert("error", "Unable to generate a link for the local version of the page.");
      return; 
    }
    navigator.clipboard.writeText(newlink).then(function() {
      saveAlert("info", "Link copied to clipboard!");
      window.scrollTo({top: 0, left: 0, behavior: 'smooth'});
      //window.location.href = newlink;
      window.onscroll = e => {
        let currentScrollOffset = window.pageYOffset || document.documentElement.scrollTop;
        // Scroll reach the target
        if (currentScrollOffset === 0) {
          window.location.href = newlink;
          window.onscroll = null; // remove listener
        }
      }
    }, function(err) {
      doAlert("error", "Could not copy text");
    });
  }
  function downloadFile(filename, text) {
    var element = document.createElement('a');
    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    element.setAttribute('download', filename);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
  }
  function formatExport(input){
    let out = `#ifndef myoptions_h\n#define myoptions_h\n\n/* Generated by myoptions.h generator - ${GVERSION} */\n/* Put this file next to yoRadio.ino and restart Arduino IDE. */\n/* !!! Do not be alarmed, all right, the default values ​​are not included in this file !!! */\n\n${input}\n\n#endif\n`;
    downloadFile("myoptions.h", out);
  }
  function doExport(){
    if(!validatePins()) {
      //alert("Error filling values");
      doAlert("error", "Error filling values");
      return;
    }
    let forexport = document.getElementsByClassName("forexport");
    let outstr = "";
    for (var i = 0; i < forexport.length; i++) {
      if(forexport[i].offsetParent === null) continue;
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="RADIO"){
        let define = forexport[i].getAttribute('data-define');
        let elements = forexport[i].getElementsByClassName("radio");
        for (var j = 0; j < elements.length; j++) {
          if(elements[j].checked && elements[j].offsetParent !== null){
            let dtype = elements[j].getAttribute('data-type');
            if(dtype=="default") break;
            outstr += "#define " + define + "\t\t\t" + dtype + "\n";
            break;
          }
        }
        let rotate90 = document.getElementsByClassName("rotate90")[0];
        let invertTitle = document.getElementsByClassName("invert-title")[0];
        if(rotate90.checked && rotate90.offsetParent !== null && forexport[i].hasAttribute("data-displays")) outstr += "#define ROTATE_90\t\t\ttrue\n";
        if(invertTitle.checked && invertTitle.offsetParent !== null && forexport[i].hasAttribute("data-invert")) outstr += "#define DSP_INVERT_TITLE\t\t\ttrue\n";
      }
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="PINS"){
        let isButtons = forexport[i].classList.contains("buttons-pins");
        let elements = forexport[i].getElementsByClassName("textinput");
        for (var j = 0; j < elements.length; j++) {
          if(elements[j].offsetParent !== null){
            let define = elements[j].getAttribute('data-define');
            let dtype = elements[j].value;
            if(dtype==""){
              elements[j].classList.add("error");
              elements[j].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
              return;
            }
            if(defaultValues[define]!=dtype) outstr += "#define " + define + "\t\t\t" + dtype + "\n";
          }
        }
        if(isButtons){
          let buttonpullup = document.getElementsByClassName("buttonspullup")[0];
          if(!buttonpullup.checked && buttonpullup.offsetParent !== null) outstr += "#define BTN_INTERNALPULLUP\t\t\tfalse\n";
        }
      }
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="SET"){
        let elements = forexport[i].getElementsByClassName("setitem");
        for (var j = 0; j < elements.length; j++) {
          if(elements[j].offsetParent !== null && elements[j].checked != (elements[j].getAttribute('data-default') === 'true')){
            let define = elements[j].getAttribute('data-define');
            outstr += "#define " + define + "\t\t\t" + elements[j].checked + "\n";
          }
        }
      }
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="AUDIO"){
        if(document.getElementsByClassName("vs1053")[0].checked) outstr += "#define I2S_DOUT\t\t\t255\n";
        if(document.getElementsByClassName("i2s-internal")[0].checked) outstr += "#define I2S_INTERNAL\t\t\ttrue\n";
        if(document.getElementsByClassName("force-mono")[0].checked) outstr += "#define PLAYER_FORCE_MONO\t\t\ttrue\n";
      }
      /*************************************************************/
    }
    formatExport(outstr);
  }
</script>

</html>
